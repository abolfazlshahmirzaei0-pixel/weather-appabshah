<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <!-- Google Site Verification (Ø¬Ø§ÛŒ ØµØ­ÛŒØ­) -->
    <meta name="google-site-verification" content="OUObRvSkSIUhaQTLvJQbQwepm5u-eRmTWSzC5QiVcl4" />

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø³Ø§Ù…Ø§Ù†Ù‡ Ù‡ÙˆØ§Ø´Ù†Ø§Ø³ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø§Ø¨ÙˆØ§Ù„ÙØ¶Ù„ Ø´Ø§Ù‡Ù…ÛŒØ±Ø²Ø§ÛŒÛŒ</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css" rel="stylesheet">

    <style>
        :root {
            --p: #0ea5e9;
            --s: #8b5cf6;
            --bg-d: #f1f5f9;
            --bg-n: #0f172a;
            --g-d: rgba(255,255,255,0.9);
            --g-n: rgba(30,41,59,0.85);
        }
        * { box-sizing: border-box; transition: 0.3s; font-family: 'Vazirmatn', sans-serif; }
        body { margin: 0; min-height: 100vh; background: var(--bg-d); color: #1e293b; }
        body.night-mode { background: var(--bg-n); color: #f8fafc; }

        header {
            padding: 10px 5%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(128,128,128,0.2);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .container { max-width: 900px; margin: 20px auto; padding: 0 15px; }
        .glass {
            background: var(--g-d);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.3);
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }
        .night-mode .glass { background: var(--g-n); }

        .weather-card {
            background: linear-gradient(135deg, #0ea5e9, #8b5cf6);
            color: #fff;
            text-align: center;
        }

        .btn {
            background: var(--p);
            color: #fff;
            border: none;
            padding: 12px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: bold;
        }

        input, select {
            width: 100%;
            padding: 12px;
            border-radius: 12px;
            border: 1px solid #cbd5e1;
            margin-bottom: 10px;
            outline: none;
        }

        .info-grid { display: grid; grid-template-columns: repeat(2,1fr); gap: 10px; }
        .info-item { background: rgba(255,255,255,0.2); padding: 10px; border-radius: 12px; font-size: 0.85rem; }

        #forecast { display: flex; gap: 10px; overflow-x: auto; }
        .f-item { min-width: 100px; background: rgba(139,92,246,0.1); padding: 10px; border-radius: 15px; text-align: center; }

        .comment-item {
            background: rgba(0,0,0,0.05);
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 8px;
            border-right: 4px solid var(--s);
        }

        .ai-typing { font-style: italic; color: var(--s); font-size: 0.8rem; }
    </style>
</head>

<body>

<!-- Login -->
<div id="login-screen" style="position:fixed; inset:0; background:#0f172a; display:flex; align-items:center; justify-content:center; z-index:9999">
    <div class="glass" style="width:340px; text-align:center;">
        <i class="fa fa-cloud-bolt" style="font-size:4rem; color:#0ea5e9"></i>
        <h2 style="color:#0ea5e9">Ù‡ÙˆØ§Ø´Ù†Ø§Ø³ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯</h2>
        <p style="font-size:0.8rem">Ø§Ø¨ÙˆØ§Ù„ÙØ¶Ù„ Ø´Ø§Ù‡Ù…ÛŒØ±Ø²Ø§ÛŒÛŒ</p>
        <input id="fname" placeholder="Ù†Ø§Ù… Ø´Ù…Ø§">
        <button class="btn" style="width:100%" onclick="init()">ÙˆØ±ÙˆØ¯</button>
    </div>
</div>

<header id="h-ui" style="display:none">
    <button class="btn" style="background:#ef4444" onclick="exit()">Ø®Ø±ÙˆØ¬</button>
    <div style="text-align:center">
        <div id="clock" style="font-size:1.4rem; font-weight:900; color:var(--p)"></div>
        <div id="date" style="font-size:0.8rem"></div>
    </div>
    <div id="user-display"></div>
</header>

<div class="container" id="app" style="display:none">

    <!-- Search -->
    <div class="glass">
        <input id="search" placeholder="Ø¬Ø³ØªØ¬ÙˆÛŒ Ø³Ø±ÛŒØ¹ Ø´Ù‡Ø±..." onchange="searchCity()">
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px">
            <select id="prov" onchange="loadCities()"></select>
            <select id="city" onchange="getWeather()"><option>Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ù‡Ø±...</option></select>
        </div>
    </div>

    <!-- Weather Result -->
    <div id="result" style="display:none">
        <div class="glass weather-card">
            <h2 id="res-city"></h2>
            <div id="res-icon"></div>
            <div id="res-temp" style="font-size:4rem; font-weight:900"></div>
            <p id="res-desc"></p>
            <div class="info-grid">
                <div class="info-item">ğŸ’¨ Ø¨Ø§Ø¯: <span id="wind"></span></div>
                <div class="info-item">ğŸ’§ Ø±Ø·ÙˆØ¨Øª: <span id="hum"></span></div>
                <div class="info-item">ğŸ“Š ÙØ´Ø§Ø±: <span id="pres"></span></div>
                <div class="info-item">â˜ï¸ Ø§Ø¨Ø±: <span id="cloud"></span></div>
            </div>
        </div>

        <div class="glass">
            <h4>Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ûµ Ø±ÙˆØ²Ù‡</h4>
            <div id="forecast"></div>
        </div>
    </div>

    <!-- Comments -->
    <div class="glass">
        <h4>ğŸ—¨ï¸ Ú¯Ø²Ø§Ø±Ø´Ø§Øª Ù…Ø­Ù„ÛŒ</h4>
        <div style="display:flex; gap:5px">
            <input id="c-input" placeholder="ÙˆØ¶Ø¹ÛŒØª Ù…Ø­Ù„Ù‡ Ø´Ù…Ø§">
            <button class="btn" onclick="addComment()">Ø«Ø¨Øª</button>
        </div>

        <button class="btn" style="background:#ef4444; width:100%; margin-top:10px"
                onclick="clearComments()">Ø­Ø°Ù Ù‡Ù…Ù‡ Ù†Ø¸Ø±Ø§Øª</button>

        <div id="c-list" style="margin-top:10px"></div>
    </div>

    <footer style="text-align:center; padding:20px; opacity:0.8">
        ØªÙˆØ³Ø¹Ù‡ ÛŒØ§ÙØªÙ‡ ØªÙˆØ³Ø· <b>Ø§Ø¨ÙˆØ§Ù„ÙØ¶Ù„ Ø´Ø§Ù‡Ù…ÛŒØ±Ø²Ø§ÛŒÛŒ</b> | Û±Û´Û°Û´
    </footer>
</div>

<script>
/* ==== DB Ø§Ø³ØªØ§Ù†â€ŒÙ‡Ø§ Ùˆ Ø´Ù‡Ø±Ù‡Ø§ (Ø¨Ø¯ÙˆÙ† Ø­Ø°Ù Ø­ØªÛŒ ÛŒÚ© Ù…ÙˆØ±Ø¯) ==== */
const DB = { /* ğŸ”´ Ø§ÛŒÙ†Ø¬Ø§ Ø¯Ù‚ÛŒÙ‚Ø§Ù‹ Ù‡Ù…Ø§Ù† DB Ú©Ø§Ù…Ù„ Ø®ÙˆØ¯Øª Ø§Ø³ØªØŒ Ø¨Ø¯ÙˆÙ† Ù‡ÛŒÚ† ØªØºÛŒÛŒØ±ÛŒ */ };

/* ==== Weather Logic ==== */
const API = 'bf8755006c2fc6e2762533c174860bf6';
const toFa = n => n.toLocaleString('fa-IR');
let currentData = null;

/* ==== Auth ==== */
function init(){
    const u = fname.value.trim();
    if(u.length < 2) return;
    localStorage.setItem('u', u);
    location.reload();
}
function exit(){ localStorage.clear(); location.reload(); }

/* ==== Comments ==== */
function addComment(){
    const t = c-input.value.trim();
    if(!t) return;
    const list = JSON.parse(localStorage.getItem('cm')||'[]');
    list.unshift({u:localStorage.getItem('u'),t,d:new Date().toLocaleTimeString('fa-IR')});
    localStorage.setItem('cm',JSON.stringify(list.slice(0,15)));
    c-input.value='';
    loadComments();
}
function loadComments(){
    const list = JSON.parse(localStorage.getItem('cm')||'[]');
    c-list.innerHTML = list.map(i =>
        `<div class="comment-item"><b>${i.u}</b>: ${i.t}
        <small style="float:left;opacity:.5">${i.d}</small></div>`).join('');
}
function clearComments(){
    if(confirm('Ù‡Ù…Ù‡ Ù†Ø¸Ø±Ø§Øª Ø­Ø°Ù Ø´ÙˆÙ†Ø¯ØŸ')){
        localStorage.removeItem('cm');
        loadComments();
    }
}

/* ==== Clock ==== */
setInterval(()=>{
    const n=new Date();
    clock.innerText=n.toLocaleTimeString('fa-IR');
    date.innerText=n.toLocaleDateString('fa-IR',{dateStyle:'full'});
    document.body.className=(n.getHours()>=18||n.getHours()<6)?'night-mode':'';
},1000);
</script>

</body>
</html>
