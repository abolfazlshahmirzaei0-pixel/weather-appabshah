<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ููุงุดูุงุณ ููุดููุฏ ุงุฑุงู ๐ฎ๐ท</title>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #00838f;
            --secondary: #00bfa5;
            --glass: rgba(255, 255, 255, 0.8);
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Vazirmatn', sans-serif;
            direction: rtl;
            margin: 0;
            background: #f0f4f7;
            transition: all 0.5s ease;
        }

        /* ูุฏุฑ ูุชุญุฑฺฉ ู ููุดููุฏ */
        header {
            text-align: center;
            padding: 50px 20px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-bottom-left-radius: 60px;
            border-bottom-right-radius: 60px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        header.night-mode {
            background: linear-gradient(135deg, #1a237e, #303f9f) !important;
        }

        .container {
            max-width: 1000px;
            margin: -40px auto 40px;
            padding: 0 20px;
        }

        .card {
            background: var(--glass);
            backdrop-filter: blur(10px);
            border-radius: 25px;
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            border: 1px solid rgba(255,255,255,0.3);
        }

        /* ุงุณุชุงู ุงูุชุฎุงุจโฺฏุฑูุง */
        .selectors {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        select {
            padding: 12px 20px;
            border-radius: 12px;
            border: 1px solid #ddd;
            font-family: 'Vazirmatn';
            min-width: 180px;
            cursor: pointer;
            outline: none;
        }

        /* ฺฏุฑุฏ ูพุดโุจู */
        .forecast-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .forecast-item {
            background: rgba(255,255,255,0.5);
            padding: 15px;
            border-radius: 20px;
            text-align: center;
            transition: 0.3s;
        }

        .forecast-item:hover { transform: translateY(-5px); background: #fff; }

        .weather-icon { font-size: 3rem; color: var(--primary); margin-bottom: 10px; }
        .temp-main { font-size: 3rem; font-weight: bold; color: #d32f2f; }

        @media (max-width: 600px) {
            header h1 { font-size: 1.5rem; }
            .selectors { flex-direction: column; }
        }
    </style>
</head>
<body>

<header id="main-header">
    <div id="header-weather-icon" style="font-size: 4rem;"></div>
    <h1>ููุงุดูุงุณ ููุดููุฏ ุงุฑุงู ๐ฎ๐ท</h1>
    <p id="live-clock">ุฏุฑ ุญุงู ุฏุฑุงูุช ุฒูุงู...</p>
</header>

<main class="container">
    <section class="card selectors">
        <select id="province-select"><option value="">ุงูุชุฎุงุจ ุงุณุชุงู</option></select>
        <select id="city-select" disabled><option value="">ุงูุชุฎุงุจ ุดูุฑ</option></select>
    </section>

    <section id="weather-display" style="display:none">
        <div class="card" style="text-align: center;">
            <h2 id="city-title"></h2>
            <div id="current-info"></div>
        </div>

        <div class="card">
            <h3>ูพุดโุจู ต ุฑูุฒ ุขูุฏู</h3>
            <div id="forecast-list" class="forecast-grid"></div>
        </div>
    </section>
</main>

<script>
    const API_KEY = 'bf8755006c2fc6e2762533c174860bf6';
    
    // ูุณุช ฺฉุงูู ุงุณุชุงูโูุง ู ุดูุฑูุง (ุจุฑฺฏุฑูุชู ุงุฒ ูุงู ุดูุง)
    const provinces = {
        "ุขุฐุฑุจุงุฌุงู ุดุฑู": ["ุชุจุฑุฒ","ูุฑุงุบู","ูุฑูุฏ","ุงูุฑ","ูุงูู","ุจูุงุจ","ุดุจุณุชุฑ","ุฌููุง","ุณููุฏ","ุณุฑุงุจ","ูุดุชุฑูุฏ","ฺฉูุจุฑ","ุงุณฺฉู","ุจุณุชุงูโุขุจุงุฏ","ุขุฐุฑุดูุฑ","ูุฑุณ","ุนุฌุจโุดุฑ","ูุฑุฒูุงู","ููฺฉุงู","ูุฑูโุขุบุงุฌ","ูุจุงุฑฺฉโุดูุฑ","ุชุณูุฌ","ุฎุณุฑูุดุงู","ุตููุงู","ุดุฑูุฎุงูู","ุชุฑฺฉููฺุง","ุจุงุฑูู","ููุงู","ุดูุฑ ุฌุฏุฏ ุณููุฏ"],
        "ุขุฐุฑุจุงุฌุงู ุบุฑุจ": ["ุงุฑููู","ุฎู","ููุงุจุงุฏ","ุจูฺฉุงู","ูุงูุฏูุขุจ","ุณููุงุณ","ูพุฑุงูุดูุฑ","ููุฏู","ุดุงููโุฏฺ","ุณุฑุฏุดุช","ูุงฺฉู","ุชฺฉุงุจ","ุงุดููู","ูุฑูโุถุงุกุงูุฏู","ฺุงูพุงุฑู","ูพูุฏุดุช","ุดูุท","ุณุฑูุงู","ุฑุจุท","ุจุงุฒุฑฺฏุงู","ููุดูโุดูุฑ","ููุดฺ","ฺฉุฑูุงูุฌ","ููุงฺฏูุฏ","ุณููุงูุง"],
        "ุงุฑุฏุจู": ["ุงุฑุฏุจู","ูพุงุฑุณโุขุจุงุฏ","ูุดฺฏูโุดูุฑ","ุฎูุฎุงู","ููู","ูุฑ","ฺฏุฑู","ุจููโุณูุงุฑ","ฺฉูุซุฑ","ุณุฑุนู","ฺฏู","ุงุตูุงูุฏูุฒ","ูุฑ","ุฌุนูุฑุขุจุงุฏ","ูุฑูุฒุขุจุงุฏ","ฺฉููุฑ","ุชุงุฒู ฺฉูุฏ","ฺฉูุฑุงู","ุงุณูุงูโุขุจุงุฏ","ูพูุงุดูุฑ","ุฑุถ"],
        "ุงุตููุงู": ["ุงุตููุงู","ฺฉุงุดุงู","ุฎููโุดูุฑ","ูุฌูโุขุจุงุฏ","ููุงูุฑุฌุงู","ุดุงููโุดูุฑ","ุดูุฑุถุง","ูุจุงุฑฺฉู","ุฒุฑูโุดูุฑ","ฺฏููพุงฺฏุงู","ุฎูุงูุณุงุฑ","ูุงู","ุฏุฑฺู","ุงุฑุฏุณุชุงู","ฺุงุฏฺฏุงู","ุฏููุชโุขุจุงุฏ","ููุฌุงู","ููู","ูููุงุฏุดูุฑ","ฺฉูููพุงู","ุขุฑุงู ู ุจุฏฺฏู","ูุฑุฒูู","ุฏูุงูุงู","ุณูุฑู"],
        "ุงูุจุฑุฒ": ["ฺฉุฑุฌ","ูุฑุฏุณ","ฺฉูุงูโุดูุฑ","ูุธุฑุขุจุงุฏ","ูุญูุฏุดูุฑ","ูุงูุฏุดุช","ููุฑุดูุฑ","ูุดุชฺฏุฑุฏ","ุงุดุชูุงุฑุฏ","ุทุงููุงู","ฺูุงุฑุจุงุบ","ฺฏููุฑุฏุดุช","ฺฉููุณุงุฑ","ฺฉููฺฉ","ุณุงูุฌุจูุงุบ","ูุดุชฺฏุฑุฏ ุฌุฏุฏ"],
        "ุงูุงู": ["ุงูุงู","ุฏููุฑุงู","ุฏุฑูโุดูุฑ","ุงูุงู","ููุฑุงู","ุขุจุฏุงูุงู","ุณุฑุงุจูู","ฺุฑุฏุงูู","ุจุฏุฑู","ููฺฉุดุงู","ูููุงุฑ","ููุณุงู","ฺูุงุฑ","ููู","ุงุฑฺฉูุงุฒ"],
        "ุจูุดูุฑ": ["ุจูุดูุฑ","ุจุฑุงุฒุฌุงู","ฺฏูุงูู","ุฎูุฑููุฌ","ฺฉูฺฏุงู","ุนุณููู","ุฌู","ุฏูู","ุฏุฑ","ุดุจุงูฺฉุงุฑู","ฺฉุงฺฉ","ุงูุฑู","ุฎุงุฑฺฏ","ุจูุฏุฑ ุณุฑุงู","ุจูุฏุฑ ุฑฺฏ","ุจูุฏุฑ ุฏุฑ","ุขุจูพุฎุด","ุณุนุฏุขุจุงุฏ","ุฏููุงุฑ","ฺุบุงุฏฺฉ"],
        "ุชูุฑุงู": ["ุชูุฑุงู","ุงุณูุงูโุดูุฑ","ุดูุฑุงุฑ","ูุฏุณ","ููุงุฑุฏ","ูุณูโุดูุฑ","ุฑ","ุฑุจุงุทโฺฉุฑู","ูุฑุงูู","ูุฑฺฺฉ","ูพุงฺฉุฏุดุช","ุงูุฏุดู","ูพุฑุฏุณ","ุฏูุงููุฏ","ุจูููู","ุดุฑูโุขุจุงุฏ","ุฑูุฏูู","ฺฉูุฑุฒฺฉ","ุจุงุบุณุชุงู","ูุฑุฏูุณู","ุดูุฑ ุฑ","ุจุงูุฑุดูุฑ","ูุงูุงู","ูุดุงููู","ฺุชฺฏุฑ"],
        "ฺูุงุฑูุญุงู ู ุจุฎุชุงุฑ": ["ุดูุฑฺฉุฑุฏ","ุจุฑูุฌู","ูุงุฑุณุงู","ูุฑุฏฺฏุงู","ุงุฑุฏู","ฺฉููุฑูฺฏ","ุณุงูุงู","ุจู","ฺฉุงุฑ","ูุฑุฎโุดูุฑ","ุจูุฏุงุฌ","ุณูุฑุดุฌุงู","ฺูฺฏุฑุฏ","ุฌูููุงู","ฺฏูุฏูุงู","ูุงุบุงู","ุดููุฒุงุฑ","ุจุงุจุงุญุฏุฑ","ุฏุดุชฺฉ"],
        "ุฎุฑุงุณุงู ุฌููุจ": ["ุจุฑุฌูุฏ","ูุงุฆู","ูุฑุฏูุณ","ููุจูุฏุงู","ุทุจุณ","ุณุฑุงุงู","ุจุดุฑูู","ุฎูุณู","ุงุณุฏู","ุฏุฑูุงู","ุฒุฑฺฉูู","ุขุณฺฉ","ููุณุชุงู","ููุฏ","ุฏููฺฉ"],
        "ุฎุฑุงุณุงู ุฑุถู": ["ูุดูุฏ","ุณุจุฒูุงุฑ","ูุดุงุจูุฑ","ุชุฑุจุช ุญุฏุฑู","ฺฉุงุดูุฑ","ููฺุงู","ุจุฑุฏุณฺฉู","ฺูุงุฑุงู","ูุฑูุงู","ุฎูุงู","ุชุงุจุงุฏ","ุชุฑุจุช ุฌุงู","ฺฏูุงุจุงุฏ","ุฏุฑฺฏุฒ","ุณุฑุฎุณ","ฺฉูุงุช","ุฑุดุชุฎูุงุฑ","ูู ููุงุช","ุทุฑูุจู","ุดุงูุฏุฒ","ุจุฌุณุชุงู","ุฎููโุขุจุงุฏ"],
        "ุฎุฑุงุณุงู ุดูุงู": ["ุจุฌููุฑุฏ","ุดุฑูุงู","ุงุณูุฑุงู","ุฌุงุฌุฑู","ูุงูู ู ุณูููุงู","ูุงุฑูุฌ","ฺฏุฑูู","ุฑุงุฒ ู ุฌุฑฺฏูุงู","ูุงุถ","ุฏุฑู","ุงูุฑ","ุขูุง","ููุฌู","ุบูุงูุงู","ุฒุงุฑุช","ุขุดุฎุงูู"],
        "ุฎูุฒุณุชุงู": ["ุงููุงุฒ","ุฏุฒููู","ุขุจุงุฏุงู","ุฎุฑูุดูุฑ","ุงูุฏูุดฺฉ","ูุณุฌุฏุณููุงู","ุงุฐู","ุจูุจูุงู","ุดูุดุชุฑ","ูุงูุดูุฑ","ุณูุณูฺฏุฑุฏ","ุดูุด","ุจุงุบโููฺฉ","ุฑุงูุดุฑ","ุดุงุฏฺฏุงู","ุงูุฏู","ููุฏุฌุงู","ูุงู","ุฑุงููุฑูุฒ","ุฏุดุช ุขุฒุงุฏฺฏุงู","ุงูุฏฺฉุง","ุดูุด","ุฏุดุชโุขุฒุงุฏฺฏุงู"],
        "ุฒูุฌุงู": ["ุฒูุฌุงู","ุงุจูุฑ","ุฎุฑูุฏุฑู","ูุฏุงุฑ","ุณูุทุงูู","ูุงููุดุงู","ุณุฌุงุณ","ุฒุฑูโุขุจุงุฏ","ุฏูุฏ","ุงุฑูุบุงูุฎุงูู","ููุฑุจูุงุฑ","ุณุฌู","ูุฏุฌ","ุตุงูโููุนู","ุขุจโุจุฑ","ุณูุฑูุฑุฏ","ฺูุฑุฒู"],
        "ุณููุงู": ["ุณููุงู","ุดุงูุฑูุฏ","ุฏุงูุบุงู","ฺฏุฑูุณุงุฑ","ููุฏโุดูุฑ","ุงูุงูฺฉ","ุจุณุทุงู","ูุงู","ุณุฑุฎู","ุฏุจุงุฌ","ุจุงุฑุฌููุฏ","ุดููุฑุฒุงุฏ","ฺฉุงููพูุด","ูุฌู","ุญุณูโุขุจุงุฏ"],
        "ุณุณุชุงู ู ุจููฺุณุชุงู": ["ุฒุงูุฏุงู","ุฒุงุจู","ุงุฑุงูุดูุฑ","ฺุงุจูุงุฑ","ุฎุงุด","ุณุฑุงูุงู","ฺฉูุงุฑฺฉ","ูฺฉโุดูุฑ","ุณุฑุจุงุฒ","ุฑุงุณฺฉ","ูููุฌ","ููุฑุณุชุงู","ูุตุฑููุฏ","ุณุจ ู ุณูุฑุงู","ุฏุดุชุงุฑ","ุฏูฺฏุงู","ูพุดู"],
        "ูุงุฑุณ": ["ุดุฑุงุฒ","ูุฑูุฏุดุช","ฺฉุงุฒุฑูู","ุฌูุฑู","ูุณุง","ูุงุฑ","ูุฑูุฒุขุจุงุฏ","ุงููุฏ","ุฏุงุฑุงุจ","ูุงูุฑุฏ","ููุฑุขุจุงุฏ","ููุณู","ูโุฑุฒ","ุขุจุงุฏู","ุตูุงุดูุฑ","ุงุณุชูุจุงู","ฺฏุฑุงุด","ุฎูุฌ","ูุฑ ู ฺฉุงุฑุฒู","ูพุงุณุงุฑฺฏุงุฏ","ุจูุงูุงุช","ุณุฑูุณุชุงู"],
        "ูุฒูู": ["ูุฒูู","ุชุงฺฉุณุชุงู","ุงูููุฏ","ุงูุจุงูู","ุขุจฺฉ","ุจุฏุณุชุงู","ุจูุฆูโุฒูุฑุง","ุดุงู","ููุฑฺฏุงู","ุงุณูุฑูุฑู","ฺฉููู","ุขูุฌ","ุถุงุกุขุจุงุฏ","ุฎุงฺฉุนู"],
        "ูู": ["ูู","ุฌุนูุฑู","ฺฉูฺฉ","ุณููฺฺฏุงู","ุฏุณุชุฌุฑุฏ","ูููุงุช","ฺฉูุดุง","ููุตุฑ"],
        "ฺฉุฑุฏุณุชุงู": ["ุณููุฏุฌ","ุณูุฒ","ูุฑูุงู","ุจุงูู","ูุฑูู","ฺฉุงูุงุฑุงู","ุฏูุงูุฏุฑู","ุจุฌุงุฑ","ุณุฑูุขุจุงุฏ","ุฏูฺฏูุงู","ููฺุด","ุณุฑุดโุขุจุงุฏ","ุฏูุจุฑุงู"],
        "ฺฉุฑูุงู": ["ฺฉุฑูุงู","ุณุฑุฌุงู","ุฑูุณูุฌุงู","ุฌุฑูุช","ุจู","ฺฉูููุฌ","ุจุงูุช","ุจุฑุฏุณุฑ","ุฒุฑูุฏ","ุนูุจุฑุขุจุงุฏ","ุดูุฑุจุงุจฺฉ","ูููุฌุงู","ููุนูโฺฏูุฌ","ุฑุงูุฑ","ฺฉููุจูุงู","ุฑฺฏุงู","ููุฑุฌ","ุงูุงุฑ","ุฑูุฏุจุงุฑ"],
        "ฺฉุฑูุงูุดุงู": ["ฺฉุฑูุงูุดุงู","ุงุณูุงูโุขุจุงุฏ ุบุฑุจ","ุฌูุงูุฑูุฏ","ฺฉูฺฏุงูุฑ","ุตุญูู","ุณููุฑ","ูพุงูู","ูุฑุณู","ูุตุฑ ุดุฑู","ุณุฑูพู ุฐูุงุจ","ฺฏูุงูุบุฑุจ","ุฑูุงูุณุฑ","ุซูุงุซ ุจุงุจุงุฌุงู","ฺฉูุฒุฑุงู","ูุงูุฏุดุช"],
        "ฺฉูฺฏููู ู ุจูุฑุงุญูุฏ": ["ุงุณูุฌ","ฺฏฺุณุงุฑุงู","ุฏูฺฏูุจุฏุงู","ุฏูุฏุดุช","ูฺฉฺฉ","ุจุงุดุช","ุณโุณุฎุช","ฺุฑุงู","ููุฏู","ุณูู","ูพุงุชุงูู","ูุงุฏูุงู"],
        "ฺฏูุณุชุงู": ["ฺฏุฑฺฏุงู","ฺฏูุจุฏ ฺฉุงููุณ","ุจูุฏุฑ ุชุฑฺฉูู","ุนูโุขุจุงุฏ ฺฉุชูู","ุขูโููุง","ฺฉุฑุฏฺฉู","ูููุฏุดุช","ฺฏุงูฺฉุด","ฺฉูุงูู","ุฑุงูุงู","ุขุฒุงุฏุดูุฑ","ฺฏูุดุงู","ุณููโุดูุฑ","ููฺฉูุฏู","ุฎุงู ุจุจู","ุงูฺูโุจุฑูู"],
        "ฺฏูุงู": ["ุฑุดุช","ุงูุฒู","ูุงูุฌุงู","ููฺฏุฑูุฏ","ุชุงูุด","ุฑูุฏุจุงุฑ","ุฑูุฏุณุฑ","ูููู","ุตููุนูโุณุฑุง","ุขุณุชุงูู ุงุดุฑูู","ุขุณุชุงุฑุง","ูุงุณุงู","ุณุงูฺฉู","ุงููุด","ุฑุถูุงูโุดูุฑ","ฺฉูฺุตููุงู","ฺฉุงุดูุฑ","ุดูุช","ฺูุฎุงูู","ุฑุญูโุขุจุงุฏ","ููุดุงู","ฺฉูุงฺุง"],
        "ูุฑุณุชุงู": ["ุฎุฑูโุขุจุงุฏ","ุจุฑูุฌุฑุฏ","ุฏูุฑูุฏ","ฺฉููุฏุดุช","ุงูฺฏูุฏุฑุฒ","ููุฑุขุจุงุฏ","ูพูุฏุฎุชุฑ","ุงุฒูุง","ุงูุดุชุฑ","ฺฺฏู","ูุนูููุงู","ุณุฑุงุจ ุฏูุฑู","ุฑููุดฺฏุงู","ฺฉููุงู","ฺุบุงุจู"],
        "ูุงุฒูุฏุฑุงู": ["ุณุงุฑ","ุจุงุจู","ุขูู","ูุงุฆูโุดูุฑ","ุจุงุจูุณุฑ","ุจูุดูุฑ","ุชูฺฉุงุจุงุฏ","ููุดูุฑ","ฺุงููุณ","ูุฑุฏููโฺฉูุงุฑ","ุฑุงูุณุฑ","ููุฑ","ูุญููุฏุขุจุงุฏ","ูฺฉุง","ุฌูุจุงุฑ","ุนุจุงุณโุขุจุงุฏ","ุณูุงุฏฺฉูู","ฺฉูุงุฑุฏุดุช"],
        "ูุฑฺฉุฒ": ["ุงุฑุงฺฉ","ุณุงูู","ุฎูู","ูุญูุงุช","ุฏูุฌุงู","ุฒุฑูุฏู","ุดุงุฒูุฏ","ุขุดุชุงู","ูุฑุงูุงู","ุชูุฑุด","ุณุฑุจูุฏ","ฺฉูุฌุงู","ููุงุฌุฑุงู","ูุฃูููู","ููุจุฑุงู"],
        "ูุฑูุฒฺฏุงู": ["ุจูุฏุฑุนุจุงุณ","ููุงุจ","ูุดู","ฺฉุด","ุจูุฏุฑ ููฺฏู","ุฑูุฏุงู","ุฌุงุณฺฉ","ุจุณุชฺฉ","ุญุงุฌโุขุจุงุฏ","ูพุงุฑุณุงู","ุณุฑฺฉ","ุจุดุงฺฏุฑุฏ","ฺฉููุณุชฺฉ","ุชูฺฏู","ฺุงุฑฺฉ","ุณูุฏุฑฺฉ"],
        "ููุฏุงู": ["ููุฏุงู","ููุงุฑ","ููุงููุฏ","ุชูุณุฑฺฉุงู","ุงุณุฏุขุจุงุฏ","ฺฉุจูุฏุฑุงููฺฏ","ุจูุงุฑ","ุฑุฒู","ูุงููู","ูุฑูู ุฏุฑุฌุฒู","ุฏูู","ุฌูฺฉุงุฑ","ุงุฒูุฏุฑุงู","ุณุงูู","ุฌูุฑูุงู","ููุงููุฏ"],
        "ุฒุฏ": ["ุฒุฏ","ูุจุฏ","ุงุฑุฏฺฉุงู","ุชูุช","ุจุงูู","ุงุจุฑฺฉูู","ููุฑุฒ","ุงุดฺฉุฐุฑ","ูุฑุงุช","ุดุงูุฏู","ุญูุฏุง","ุฒุงุฑฺ","ูุฑ","ูุฑูุณุช","ุนูุฏุง","ุจูุงุจุงุฏ","ุงุญูุฏุขุจุงุฏ","ุณุงุจุงู","ุฎุถุฑุขุจุงุฏ","ูุฏูุดู"]
    };

    // ููุทู ุฒูุงู ู ุชู (ุงุตูุงุญ ุดุฏู)
    function updateLiveUI(icon = '01d') {
        const now = new Date();
        const hour = now.getHours();
        const isNight = icon.includes('n') || (hour < 6 || hour >= 19);
        
        const header = document.getElementById('main-header');
        if (isNight) header.classList.add('night-mode');
        else header.classList.remove('night-mode');

        document.getElementById('live-clock').textContent = now.toLocaleString('fa-IR', {
            weekday: 'long', hour: '2-digit', minute: '2-digit', second: '2-digit'
        });
    }

    // ูพุฑ ฺฉุฑุฏู ูุณุช ุงุณุชุงูโูุง
    function init() {
        const pSelect = document.getElementById('province-select');
        for (let p in provinces) {
            let opt = document.createElement('option');
            opt.value = p; opt.textContent = p;
            pSelect.appendChild(opt);
        }
    }

    document.getElementById('province-select').addEventListener('change', function() {
        const cSelect = document.getElementById('city-select');
        cSelect.innerHTML = '<option value="">ุงูุชุฎุงุจ ุดูุฑ</option>';
        cSelect.disabled = !this.value;
        if (this.value) {
            provinces[this.value].forEach(c => {
                let opt = document.createElement('option');
                opt.value = c; opt.textContent = c;
                cSelect.appendChild(opt);
            });
        }
    });

    document.getElementById('city-select').addEventListener('change', async function() {
        if (!this.value) return;
        
        // ุฏุฑุงูุช ูุฎุชุตุงุช ู ุณูพุณ ููุงุดูุงุณ
        const geoReq = await fetch(`https://api.openweathermap.org/geo/1.0/direct?q=${this.value},IR&limit=1&appid=${API_KEY}`);
        const geoData = await geoReq.json();
        
        if (geoData.length > 0) {
            const {lat, lon} = geoData[0];
            const wReq = await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&lang=fa&appid=${API_KEY}`);
            const fReq = await fetch(`https://api.openweathermap.org/data/2.5/forecast?lat=${lat}&lon=${lon}&units=metric&lang=fa&appid=${API_KEY}`);
            
            showWeather(await wReq.json(), this.value);
            showForecast(await fReq.json());
        }
    });

    function showWeather(data, city) {
        document.getElementById('weather-display').style.display = 'block';
        document.getElementById('city-title').textContent = `ููุง ูุนู ${city}`;
        updateLiveUI(data.weather[0].icon);

        document.getElementById('current-info').innerHTML = `
            <div class="weather-icon"><i class="fas ${getIcon(data.weather[0].icon)}"></i></div>
            <div class="temp-main">${Math.round(data.main.temp)}ยฐC</div>
            <p>ูุถุนุช: <b>${data.weather[0].description}</b></p>
            <div style="display:flex; justify-content:center; gap:20px;">
                <span><i class="fas fa-tint"></i> ุฑุทูุจุช: ${data.main.humidity}%</span>
                <span><i class="fas fa-wind"></i> ุจุงุฏ: ${Math.round(data.wind.speed * 3.6)}km/h</span>
            </div>
        `;
    }

    function showForecast(data) {
        const list = document.getElementById('forecast-list');
        list.innerHTML = '';
        
        // ููุชุฑ ฺฉุฑุฏู ุจุฑุง ต ุฑูุฒ (ฺฉ ุฏุงุฏู ุฏุฑ ูุฑ ฒด ุณุงุนุช)
        const daily = data.list.filter((f, i) => i % 8 === 0).slice(0, 5);
        
        daily.forEach(day => {
            const date = new Date(day.dt * 1000).toLocaleString('fa-IR', {weekday: 'long'});
            list.innerHTML += `
                <div class="forecast-item">
                    <h4>${date}</h4>
                    <div style="font-size:2rem; color:var(--primary)"><i class="fas ${getIcon(day.weather[0].icon)}"></i></div>
                    <div style="font-weight:bold; color:#d32f2f; margin:10px 0;">${Math.round(day.main.temp)}ยฐC</div>
                    <div style="font-size:0.8rem">${day.weather[0].description}</div>
                </div>
            `;
        });
    }

    function getIcon(code) {
        const map = {'01':'sun','02':'cloud-sun','03':'cloud','04':'cloud','09':'cloud-showers-heavy','10':'cloud-rain','11':'bolt','13':'snowflake','50':'smog'};
        return 'fa-' + (map[code.substring(0,2)] || 'cloud');
    }

    setInterval(updateLiveUI, 1000);
    init();
</script>
</body>
</html>
